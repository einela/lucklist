import{aY as e,D as r,I as n,o as t,S as o,K as l,aw as a,M as s,E as u,bu as g,F as c,G as d,J as h,L as i,B as p,dE as f,an as w,C,ab as v,bU as b,dF as m,b9 as $,dI as k,_ as y,dG as F,aj as O,aM as x,aE as S,dH as E,ag as I,l as _,$ as z,ah as H,R,z as M,bt as P}from"./index-C_g2pi0Z.js";import{o as j,E as B}from"./index-DJbwiRYC.js";const G=f(),T=e=>{var n;const[t,o]=p("/");return null==(n=e.handle)||n.call(e,{setPath:o}),r(w,{class:"folder-tree-box",w:"$full",overflowX:"auto",get children(){return r(G.Provider,{get value(){var r,n,l,a;return{value:t,onChange:r=>{o(r),e.onChange(r)},autoOpen:null!=(r=e.autoOpen)&&r,forceRoot:null!=(n=e.forceRoot)&&n,showEmptyIcon:null!=(l=e.showEmptyIcon)&&l,showHiddenFolder:null==(a=e.showHiddenFolder)||a}},get children(){return r(D,{path:"/"})}})}})},D=n=>{const{isHidePath:t}=b(),[l,s]=p(),{value:u,onChange:g,forceRoot:c,autoOpen:d,showEmptyIcon:h,showHiddenFolder:i}=m(G),[f,T]=$(()=>k(n.path,y(),c));let J=!1;const K=async()=>{var e;if(null==(e=l())?void 0:e.length)return;const r=await T();P(r,e=>{J=!0,s(e)},()=>{L()&&U()})},{isOpen:L,onToggle:U}=e(),V=()=>u()===n.path,W=F(n.path);return C(O(u,async e=>{d&&W(e)&&(L()||U(),J||K())})),r(o,{get when(){return i||!(t(n.path)&&!W(u()))},get children(){return r(w,{get children(){return[r(a,{spacing:"$2",get children(){return[r(o,{get when(){return!f()},get fallback(){return r(E,{size:"sm",get color(){return S()}})},get children(){return r(o,{get when(){return!Boolean(h&&void 0!==l()&&!(null==(e=l())?void 0:e.length));var e},get fallback(){return r(x,{get color(){return S()},as:B})},get children(){return r(x,{get color(){return S()},as:j,get transform(){return L()?"rotate(90deg)":"none"},transition:"transform 0.2s",cursor:"pointer",onClick:()=>{U(),L()&&K()}})}})}}),r(I,{css:{whiteSpace:"nowrap"},fontSize:"$md",cursor:"pointer",px:"$1",rounded:"$md",get bgColor(){return V()?"$info8":"transparent"},get _hover(){return{bgColor:V()?"$info8":z()}},onClick:()=>{g(n.path)},get children(){return v(()=>"/"===n.path)()?"root":_(n.path)}})]}}),r(o,{get when(){return L()},get children(){return r(H,{mt:"$1",pl:"$4",alignItems:"start",spacing:"$1",get children(){return r(R,{get each(){return l()},children:e=>r(D,{get path(){return M(n.path,e.name)}})})}})}})]}})}})},J=e=>{var n;const a=t(),[g,f]=p(null!=(n=e.defaultValue)?n:"/"),[w,b]=p();return C(()=>{var r;e.opened&&(null==(r=w())||r.setPath(g()))}),r(i,{size:"xl",blockScrollOnMount:!1,get opened(){return e.opened},get onClose(){return e.onClose},get children(){return[r(s,{}),r(u,{get children(){return[r(c,{w:"$full",css:{overflowWrap:"break-word"},get children(){return e.header}}),r(d,{get children(){return[v(()=>e.children),r(T,{onChange:f,handle:e=>b(e),autoOpen:!0})]}}),r(h,{display:"flex",gap:"$2",get children(){return[r(o,{get when(){return e.footerSlot},get children(){return e.footerSlot}}),r(l,{get onClick(){return e.onClose},colorScheme:"neutral",get children(){return a("global.cancel")}}),r(l,{get loading(){return e.loading},onClick:()=>{var r;return null==(r=e.onSubmit)?void 0:r.call(e,g())},get children(){return a("global.ok")}})]}})]}})]}})},K=p=>{const{isOpen:f,onOpen:w,onClose:C}=e(),v=t();return[r(a,{w:"$full",spacing:"$2",get children(){return[r(n,{get id(){return p.id},get value(){return p.value},onInput:e=>p.onChange(e.currentTarget.value),get readOnly(){return p.onlyFolder},get onClick(){return p.onlyFolder?w:()=>{}},get placeholder(){return v("global."+(p.onlyFolder?"choose_folder":"choose_or_input_path"))}}),r(o,{get when(){return!p.onlyFolder},get children(){return r(l,{onClick:w,get children(){return v("global.choose")}})}})]}}),r(i,{size:"xl",get opened(){return f()},onClose:C,get children(){return[r(s,{}),r(u,{get children(){return[r(g,{}),r(c,{get children(){return v("global.choose_folder")}}),r(d,{get children(){return r(T,{forceRoot:!0,get onChange(){return p.onChange}})}}),r(h,{get children(){return r(l,{onClick:C,get children(){return v("global.confirm")}})}})]}})]}})]};export{T as F,J as M,K as a};
