import{j as e,b9 as r,bq as a,B as t,D as n,S as s,ah as u,c0 as o,o as c,aK as l,ab as i,ag as d,aE as g,I as h,K as v,ao as p,a6 as b,r as f,bt as y,bb as x,d9 as m}from"./index-C_g2pi0Z.js";const w=()=>{const{back:w}=e(),[_,$]=r(()=>a.post("/auth/2fa/generate")),k=c(),[q,I]=t(),[K,j]=t("");(async()=>{if(b().otp)return f.warning(k("users.2fa_already_enabled")),void w();const e=await $();y(e,I)})();const[D,E]=r(()=>{var e;return a.post("/auth/2fa/verify",{code:K(),secret:null==(e=q())?void 0:e.secret})}),S=async()=>{const e=await E();x(e,()=>{m({...b(),otp:!0}),w()})};return n(p,{get loading(){return _()},get children(){return n(s,{get when(){return q()},get children(){return n(u,{spacing:"$2",alignItems:"start",get children(){return[n(o,{get children(){return k("users.scan_qr")}}),n(l,{boxSize:"$xs",rounded:"$lg",get src(){var e;return null==(e=q())?void 0:e.qr}}),n(o,{get children(){return[i(()=>k("users.or_manual")),":"," ",n(d,{get color(){return g()},get children(){var e;return null==(e=q())?void 0:e.secret}})]}}),n(h,{maxW:"$xs",get placeholder(){return k("users.input_code")},get value(){return K()},onInput:e=>j(e.currentTarget.value),onKeyDown:e=>{"Enter"===e.key&&S()}}),n(v,{get loading(){return D()},onClick:S,get children(){return k("users.verify")}})]}})}})}})};export{w as default};
