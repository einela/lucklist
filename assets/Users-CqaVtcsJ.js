import{j as e,b9 as r,bq as n,B as t,dq as a,D as s,aw as c,K as l,o as i,an as o,dr as u,ds as d,dt as g,R as h,du as m,dv as b,dw as p,bt as f,r as $,ah as w,cz as _,aW as j,aV as k,a5 as v}from"./index-C_g2pi0Z.js";import{b as C}from"./useTitle-a7nPsmVE.js";import{D as y}from"./DeletePopover-C_LIxHes.js";import{W as S}from"./Wether-Bn5lcq9u.js";const x=e=>{const r=[{name:"general",color:"info"},{name:"guest",color:"neutral"},{name:"admin",color:"accent"}];return s(_,{get colorScheme(){return r[e.role].color},get children(){return r[e.role].name}})},D=e=>{const r=i();return s(c,{spacing:"$0_5",get children(){return s(h,{each:j,children:(n,t)=>s(k,{get label(){return r(`users.permissions.${n}`)},get children(){return s(o,{boxSize:"$2",rounded:"$full",get bg(){return`$${v.can(e.user,t())?"success":"danger"}9`}})}})})}})},W=()=>{const _=i();C("manage.sidemenu.users");const{to:j}=e(),[k,v]=r(()=>n.get("/admin/user/list")),[W,q]=t([]),z=async()=>{const e=await v();f(e,e=>q(e.content))};z();const[B,H]=a(e=>n.post(`/admin/user/delete?id=${e}`)),[I,K]=a(e=>n.post(`/admin/user/cancel_2fa?id=${e}`));return s(w,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[s(c,{spacing:"$2",get children(){return[s(l,{colorScheme:"accent",get loading(){return k()},onClick:z,get children(){return _("global.refresh")}}),s(l,{onClick:()=>{j("/@manage/users/add")},get children(){return _("global.add")}})]}}),s(o,{w:"$full",overflowX:"auto",get children(){return s(u,{highlightOnHover:!0,dense:!0,get children(){return[s(d,{get children(){return s(g,{get children(){return[s(h,{each:["username","base_path","role","permission","available"],children:e=>s(m,{get children(){return _(`users.${e}`)}})}),s(m,{get children(){return _("global.operations")}})]}})}}),s(b,{get children(){return s(h,{get each(){return W()},children:e=>s(g,{get children(){return[s(p,{get children(){return e.username}}),s(p,{get children(){return e.base_path}}),s(p,{get children(){return s(x,{get role(){return e.role}})}}),s(p,{get children(){return s(D,{user:e})}}),s(p,{get children(){return s(S,{get yes(){return!e.disabled}})}}),s(p,{get children(){return s(c,{spacing:"$2",get children(){return[s(l,{onClick:()=>{j(`/@manage/users/edit/${e.id}`)},get children(){return _("global.edit")}}),s(y,{get name(){return e.username},get loading(){return B()===e.id},onClick:async()=>{const r=await H(e.id);f(r,()=>{$.success(_("global.delete_success")),z()})}}),s(l,{colorScheme:"accent",get loading(){return I()===e.id},onClick:async()=>{const r=await K(e.id);f(r,()=>{$.success(_("users.cancel_2fa_success")),z()})},get children(){return _("users.cancel_2fa")}})]}})}})]}})})}})]}})}})]}})};export{W as default};
