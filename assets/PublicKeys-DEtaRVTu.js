import{B as e,b9 as t,bq as r,D as n,aw as s,c0 as i,ag as a,b$ as l,dj as g,K as u,o as d,bt as c,r as o,S as h,bV as w,aY as p,L as $,M as m,E as k,bu as y,F as x,G as f,bR as _,bE as S,I as b,T as A,J as v,ah as I,ab as M,Q as z}from"./index-C_g2pi0Z.js";const C=[{name:"title",textAlign:"left",w:"calc(35% - 110px)"},{name:"fingerprint",textAlign:"left",w:"calc(65% - 110px)"},{name:"last_used",textAlign:"right",w:"140px"},{name:"operation",textAlign:"right",w:"80px"}],D=w=>{const p=d(),[$,m]=e(!1),[k,y]=w.isMine?t(()=>r.post(`/me/sshkey/delete?id=${w.id}`)):t(()=>r.post(`/admin/user/sshkey/delete?uid=${w.userId}&id=${w.id}`)),x={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"};return n(h,{get when(){return!$()},get children(){return n(s,{w:"$full",p:"$2",get children(){return[n(i,{get w(){return C[0].w},size:"sm",get textAlign(){return C[0].textAlign},css:x,get children(){return w.title}}),n(a,{get w(){return C[1].w},size:"sm",get textAlign(){return C[1].textAlign},css:x,get children(){return w.fingerprint}}),n(a,{get w(){return C[2].w},size:"sm",get textAlign(){return C[2].textAlign},css:x,get children(){return`${(e=new Date(w.last_used_time)).getFullYear().toString()}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`;var e}}),n(l,{get w(){return C[3].w},gap:"$1",get children(){return[n(g,{}),n(u,{size:"sm",colorScheme:"danger",get loading(){return k()},onClick:async()=>{const e=await y();c(e,()=>{o.success(p("global.delete_success")),m(!0)})},get children(){return p("global.delete")}})]}})]}})}})},O=o=>{const O=d(),[T,j]=e([]),[B,E]=o.isMine?t(()=>r.get("/me/sshkey/list")):t(()=>r.get(`/admin/user/sshkey/list?uid=${o.userId}`)),[F,Y]=w({title:"",key:""}),[q,G]=t(()=>r.post("/me/sshkey/add",F)),{isOpen:H,onOpen:J,onClose:K}=p(),L=async()=>{const e=await E();c(e,e=>{j(e.content)})};L();const P=e=>({fontWeight:"bold",fontSize:"$sm",color:"$neutral11",textAlign:e.textAlign});return n(I,{w:"$full",alignItems:"start",spacing:"$2",get children(){return[n(l,{w:"$full",get children(){return[n(i,{get children(){return O("users.ssh_keys.heading")}}),n(h,{get when(){return o.isMine},get children(){return[n(g,{}),n(u,{get loading(){return B()},onClick:J,get children(){return O("global.add")}}),n($,{get opened(){return H()},onClose:K,scrollBehavior:"inside",get children(){return[n(m,{}),n(k,{get children(){return[n(y,{}),n(x,{get children(){return O("users.ssh_keys.add_heading")}}),n(f,{get children(){return[n(_,{mb:"$4",get children(){return[n(S,{for:"add_title",get children(){return O("users.ssh_keys.title")}}),n(b,{id:"add_title",get value(){return F.title},onInput:e=>Y("title",e.currentTarget.value)})]}}),n(_,{get children(){return[n(S,{for:"add_key",get children(){return O("users.ssh_keys.key")}}),n(A,{id:"add_key",get value(){return F.key},onInput:e=>Y("key",e.currentTarget.value)})]}})]}}),n(v,{get children(){return n(u,{get loading(){return q()},onClick:async()=>{const e=await G();c(e,()=>{Y("title",""),Y("key",""),L(),K()})},get children(){return O("global.add")}})}})]}})]}})]}})]}}),n(I,{w:"$full",overflowX:"auto",shadow:"$md",rounded:"$lg",spacing:"$1",p:"$1",get children(){return[n(s,{class:"title",w:"$full",p:"$2",get children(){return[n(a,z({get w(){return C[0].w}},()=>P(C[0]),{get children(){return O(`users.ssh_keys.${C[0].name}`)}})),n(a,z({get w(){return C[1].w}},()=>P(C[1]),{get children(){return O(`users.ssh_keys.${C[1].name}`)}})),n(a,z({get w(){return C[2].w}},()=>P(C[2]),{get children(){return O(`users.ssh_keys.${C[2].name}`)}})),n(a,z({get w(){return C[3].w}},()=>P(C[3]),{get children(){return O(`users.ssh_keys.${C[3].name}`)}}))]}}),M(()=>T().map(e=>n(D,z(o,e))))]}})]}})};export{O as P};
