import{j as e,bV as r,b9 as s,bq as n,D as a,ah as t,c0 as i,o as l,S as d,bR as u,bE as c,I as o,a5 as g,b$ as p,R as h,aW as m,bc as f,K as w,bt as b,r as $,a6 as x,d9 as y,ao as I}from"./index-C_g2pi0Z.js";import{a as _}from"./FolderTree-BBXJf3vD.js";import{P as v}from"./PublicKeys-DEtaRVTu.js";import"./index-DJbwiRYC.js";const C=e=>{const r=l();return a(u,{display:"inline-flex",flexDirection:"row",alignItems:"center",gap:"$2",rounded:"$md",shadow:"$md",p:"$2",w:"fit-content",get children(){return[a(c,{mb:"0",get children(){return r(`users.permissions.${e.name}`)}}),a(f,{get checked(){return e.can},onChange:()=>e.onChange(!e.can)})]}})},j=()=>{const j=l(),{params:k,back:q}=e(),{id:D}=k,[T,S]=r({id:0,username:"",password:"",base_path:"",role:0,permission:0,disabled:!1,sso_id:""}),[F,K]=s(()=>n.get(`/admin/user/get?id=${D}`));D&&(async()=>{const e=await K();b(e,S)})();const[P,R]=s(()=>n.post("/admin/user/"+(D?"update":"create"),T));return a(I,{get loading(){return F()},get children(){return a(t,{w:"$full",alignItems:"start",spacing:"$2",get children(){return[a(i,{get children(){return j("global."+(D?"edit":"add"))}}),a(d,{get when(){return!g.is_guest(T)},get children(){return[a(u,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[a(c,{for:"username",display:"flex",alignItems:"center",get children(){return j("users.username")}}),a(o,{id:"username",get value(){return T.username},onInput:e=>S("username",e.currentTarget.value)})]}}),a(u,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[a(c,{for:"password",display:"flex",alignItems:"center",get children(){return j("users.password")}}),a(o,{id:"password",type:"password",placeholder:"********",get value(){return T.password},onInput:e=>S("password",e.currentTarget.value)})]}})]}}),a(u,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[a(c,{for:"base_path",display:"flex",alignItems:"center",get children(){return j("users.base_path")}}),a(_,{id:"base_path",get value(){return T.base_path},onChange:e=>S("base_path",e),onlyFolder:!0})]}}),a(u,{w:"$full",required:!0,get children(){return[a(c,{display:"flex",alignItems:"center",get children(){return j("users.permission")}}),a(p,{w:"$full",wrap:"wrap",gap:"$2",get children(){return a(h,{each:m,children:(e,r)=>a(C,{name:e,get can(){return g.can(T,r())},onChange:e=>{S("permission",e?T.permission|=1<<r():T.permission&=~(1<<r()))}})})}})]}}),a(u,{w:"fit-content",display:"flex",get children(){return a(f,{css:{whiteSpace:"nowrap"},id:"disabled",onChange:e=>S("disabled",e.currentTarget.checked),color:"$neutral10",fontSize:"$sm",get checked(){return T.disabled},get children(){return j("users.disabled")}})}}),a(w,{get loading(){return P()},onClick:async()=>{const e=await R();b(e,async()=>{$.success(j("global.save_success")),T.username===x().username&&b(await n.get("/me"),y),q()})},get children(){return j("global."+(D?"save":"add"))}}),a(d,{get when(){return D&&!g.is_guest(T)},get children(){return a(v,{isMine:!1,get userId(){return parseInt(D)}})}})]}})}})};export{j as default};
