function e(e){const r=h(),{to:a}=b(),[t,n]=p(()=>w.post(`/share/delete?id=${e.share.id}`)),[i,l]=p(()=>w.post(`/share/${e.share.disabled?"enable":"disable"}?id=${e.share.id}`));return[s(o,{get disabled(){return!e.canShare},onClick:()=>{a(`/@manage/shares/edit/${e.share.id}`)},get children(){return r("global.edit")}}),s(o,{get loading(){return i()},get colorScheme(){return e.share.disabled?"success":"warning"},onClick:async()=>{const r=await l();$(r,()=>{e.refresh()})},get children(){return r("global."+(e.share.disabled?"enable":"disable"))}}),s(z,{get name(){return e.share.id},get loading(){return t()},onClick:async()=>{const a=await n();_(a,()=>{x.success(r("global.delete_success")),e.refresh()})}})]}function r(r){const f=h(),{copy:b}=a();return s(m,{get children(){return[s(t,{get children(){return(()=>{if(0===r.share.files.length)return"";let e=r.share.files[0];return r.share.files.length>1&&(e+=f("shares.files_etc",{more:r.share.files.length-1})),e})()}}),s(t,{get children(){return r.share.id}}),s(n,{get when(){return i.is_admin(l())},get children(){return s(t,{get children(){return s(B,{get name(){return r.share.creator},get role(){return r.share.creator_role}})}})}}),s(t,{get children(){return c(()=>!!r.share.expires)()?new Date(r.share.expires).toLocaleString():""}}),s(t,{get children(){return r.share.max_accessed>0?`${r.share.accessed} / ${r.share.max_accessed}`:`${r.share.accessed}`}}),s(t,{get children(){return f("shares.status_list."+(r.share.disabled?"disabled":r.share.max_accessed>0&&r.share.accessed>=r.share.max_accessed||0===r.share.files.length||r.share.expires&&new Date(r.share.expires)<new Date?"invalid":r.share.creator!==l().username||r.canShare?"work":"denied"))}}),s(t,{get children(){return r.share.remark}}),s(t,{get children(){return s(d,{spacing:"$2",get children(){return[s(o,{colorScheme:"primary",onClick:()=>{const e=q(r.share,{site_title:g("site_title")}),a=u(g("share_summary_content"),e);b(a)},get children(){return f("shares.copy_msg")}}),s(e,r)]}})}})]}})}import{bU as a,D as s,dw as t,S as n,a5 as i,a6 as l,ab as c,o as h,aw as d,K as o,V as g,bX as u,dt as m,cz as f,j as b,b9 as p,bq as w,bb as $,bt as _,r as x,B as k,aW as S,an as v,dr as y,ds as C,R as D,du as j,dv as I,ah as O}from"./index-C_g2pi0Z.js";import{b as X}from"./useTitle-a7nPsmVE.js";import{m as q}from"./share-CvvitCHF.js";import{D as z}from"./DeletePopover-C_LIxHes.js";const B=e=>{if(e.role<0)return null;const r=["info","neutral","accent"];return s(f,{get colorScheme(){return r[e.role]},css:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},get children(){return e.name}})},H=()=>{const e=h();X("manage.sidemenu.shares");const{to:a}=b(),[t,c]=p(()=>w.get("/share/list")),[g,u]=k([]),f=async()=>{const e=await c();_(e,e=>u(e.content))},$=i.can(l(),S.findIndex(e=>"share"===e));return f(),s(O,{spacing:"$3",alignItems:"start",w:"$full",get children(){return[s(d,{spacing:"$2",gap:"$2",w:"$full",wrap:{"@initial":"wrap","@md":"unset"},get children(){return[s(o,{colorScheme:"accent",get loading(){return t()},onClick:f,get children(){return e("global.refresh")}}),s(o,{disabled:!$,onClick:()=>{a("/@manage/shares/add")},get children(){return e("global.add")}})]}}),s(v,{w:"$full",overflowX:"auto",get children(){return s(y,{highlightOnHover:!0,dense:!0,get children(){return[s(C,{get children(){return s(m,{get children(){return[s(D,{each:["files","id"],children:r=>s(j,{get children(){return e(`shares.${r}`)}})}),s(n,{get when(){return i.is_admin(l())},get children(){return s(j,{get children(){return e("shares.creator")}})}}),s(D,{each:["expires","accessed","status","remark"],children:r=>s(j,{get children(){return e(`shares.${r}`)}})}),s(j,{get children(){return e("global.operations")}})]}})}}),s(I,{get children(){return s(D,{get each(){return g()},children:e=>s(r,{share:e,refresh:f,canShare:$})})}})]}})}})]}})};export{H as default};
