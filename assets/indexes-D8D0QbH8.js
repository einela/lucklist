function e(e){return t=E(),n(t,e,!0,!0),t;var t}function t(e){return t=O(),n(t,e,!0,!0),t;var t}import{ax as r,dy as n,B as a,b9 as s,bq as i,N as o,dz as l,dA as d,aY as u,D as c,c0 as g,o as h,S as m,aw as f,aM as p,ah as v,ag as k,ab as x,cz as b,cM as C,a2 as w,K as y,L as $,M as _,E as j,bu as S,F as z,G as I,T as N,I as M,J as B,bt as G,bb as L}from"./index-C_g2pi0Z.js";import{G as T}from"./index-DYpWq1ju.js";import D from"./Common-JZfnhZXX.js";import"./useTitle-a7nPsmVE.js";import"./index-DJbwiRYC.js";import"./index-CRWiqiAK.js";import"./SettingItem-CR5VVA99.js";import"./item_type-Bo2djN9R.js";import"./ResponsiveGrid-Dzear67t.js";var E=r('<svg width=1em height=1em viewBox="0 0 24 24"><g fill=none stroke=currentColor stroke-linecap=round stroke-width=2><path stroke-dasharray=60 stroke-dashoffset=60 stroke-opacity=.3 d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill=freeze attributeName=stroke-dashoffset dur=1.3s values=60;0></animate></path><path stroke-dasharray=15 stroke-dashoffset=15 d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill=freeze attributeName=stroke-dashoffset dur=0.3s values=15;0></animate><animateTransform attributeName=transform dur=1.5s repeatCount=indefinite type=rotate values="0 12 12;360 12 12">'),O=r('<svg width=1em height=1em viewBox="0 0 24 24"><g stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2><path fill=currentColor fill-opacity=0 stroke-dasharray=60 stroke-dashoffset=60 d="M3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12Z"><animate fill=freeze attributeName=stroke-dashoffset dur=0.5s values=60;0></animate><animate fill=freeze attributeName=fill-opacity begin=0.8s dur=0.15s values=0;0.3></animate></path><path fill=none stroke-dasharray=14 stroke-dashoffset=14 d="M8 12L11 15L16 10"><animate fill=freeze attributeName=stroke-dashoffset begin=0.6s dur=0.2s values=14;0>');const Z=()=>{const r=h(),[n,E]=a(),[O,Z]=s(()=>i.get("/admin/index/progress")),q=async()=>{const e=await Z();G(e,e=>{E(e)})},A=setInterval(q,5e3);o(()=>clearInterval(A)),q();const[F,H]=s(l),J=async()=>{const e=await H();L(e),q()},[K,R]=s(()=>i.post("/admin/index/clear")),X=async()=>{const e=await R();L(e),q()},[Y,P]=s(()=>i.post("/admin/index/stop")),Q=async()=>{const e=await P();L(e),q()};let U,V;const[W,ee]=s(d),te=async()=>{let e=[];U.value&&(e=U.value.split("\n"));let t=20;V.value&&(t=parseInt(V.value));const r=await ee(e,t);L(r),q()},{isOpen:re,onOpen:ne,onClose:ae}=u();return c(v,{spacing:"$2",w:"$full",alignItems:"start",get children(){return[c(g,{get children(){return r("manage.sidemenu.settings")}}),c(D,{get group(){return T.INDEX}}),c(g,{get children(){return r("indexes.current")}}),c(m,{get when(){return n()},get children(){return c(f,{spacing:"$2",w:"fit-content",shadow:"$md",rounded:"$lg",get bg(){return w("","$neutral3")()},get children(){return[c(p,{boxSize:"$28",color:"$accent9",p:"$2",get as(){var r;return(null==(r=n())?void 0:r.is_done)?t:e}}),c(v,{spacing:"$2",flex:"1",alignItems:"start",mr:"$2",get children(){return[c(k,{get children(){return[x(()=>r("indexes.obj_count")),":",c(b,{colorScheme:"info",ml:"$2",get children(){var e;return null==(e=n())?void 0:e.obj_count}})]}}),c(k,{get children(){return[x(()=>r("indexes.last_done_time")),":",c(b,{colorScheme:"accent",ml:"$2",get children(){return x(()=>!!n().last_done_time)()?C(n().last_done_time):r("indexes.unknown")}})]}}),c(m,{get when(){var e;return null==(e=n())?void 0:e.error},get children(){return c(k,{css:{wordBreak:"break-all"},get children(){return[x(()=>r("indexes.error")),":",c(b,{colorScheme:"danger",ml:"$2",get children(){return n().error}})]}})}})]}})]}})}}),c(f,{spacing:"$2",get children(){return[c(y,{colorScheme:"accent",onClick:[q,void 0],get loading(){return O()},get children(){return r("global.refresh")}}),c(y,{colorScheme:"danger",onClick:[X,void 0],get loading(){return K()},get children(){return r("indexes.clear")}}),c(y,{colorScheme:"warning",onClick:[Q,void 0],get loading(){return Y()},get children(){return r("indexes.stop")}}),c(y,{onClick:[J,void 0],get loading(){return F()},get children(){var e;return r("indexes."+((null==(e=n())?void 0:e.is_done)?"rebuild":"build"))}})]}}),c(y,{onClick:ne,get children(){return r("indexes.update")}}),c($,{get opened(){return re()},onClose:ae,get children(){return[c(_,{}),c(j,{get children(){return[c(S,{}),c(z,{get children(){return r("indexes.update")}}),c(I,{get children(){return[c(g,{get children(){return r("indexes.paths_to_update")}}),c(N,{ref(e){"function"==typeof U?U(e):U=e}}),c(g,{get children(){return r("indexes.max_depth")}}),c(M,{value:20,type:"number",ref(e){"function"==typeof V?V(e):V=e}})]}}),c(B,{get children(){return c(y,{onClick:[te,void 0],get loading(){return W()},get children(){return r("indexes.update")}})}})]}})]}})]}})};export{Z as default};
